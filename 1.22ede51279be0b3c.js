"use strict";(self.webpackChunknewport_erp=self.webpackChunknewport_erp||[]).push([[1],{7001:(ae,f,r)=>{r.r(f),r.d(f,{VentaBajaReporteUsuarioAprobarModule:()=>ne});var b=r(5412),g=r(6895),l=r(7155),x=r(7392),p=r(4006),j=r(529),_=r(1588),c=r(7800),h=r(4891),e=r(4650),u=r(8996),v=r(9479),A=r(2727);function T(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"#"),e.qZA())}function U(n,a){if(1&n&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&n){const t=a.index;e.xp6(1),e.Oqu(t+1)}}function V(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Codificaci\xf3n"),e.qZA())}function B(n,a){if(1&n&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu((null==t.informe_baja_elemento||null==t.informe_baja_elemento.informe_baja||null==t.informe_baja_elemento.informe_baja.sitio||null==t.informe_baja_elemento.informe_baja.sitio.empresa?null:t.informe_baja_elemento.informe_baja.sitio.empresa.nombre_corto)+"-"+(null==t.informe_baja_elemento||null==t.informe_baja_elemento.informe_baja||null==t.informe_baja_elemento.informe_baja.departamento||null==t.informe_baja_elemento.informe_baja.departamento.area?null:t.informe_baja_elemento.informe_baja.departamento.area.nombre_corto)+"-"+(null==t.informe_baja_elemento||null==t.informe_baja_elemento.informe_baja||null==t.informe_baja_elemento.informe_baja.sitio?null:t.informe_baja_elemento.informe_baja.sitio.nombre_corto)+"-"+(null==t.informe_baja_elemento||null==t.informe_baja_elemento.informe_baja?null:t.informe_baja_elemento.informe_baja.fecha_creacion)+"-"+(null==t.informe_baja_elemento||null==t.informe_baja_elemento.informe_baja?null:t.informe_baja_elemento.informe_baja.id)||"-")}}function Z(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"C\xf3digo Activo"),e.qZA())}function R(n,a){if(1&n&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu((null==t.informe_baja_elemento?null:t.informe_baja_elemento.codigo_activo)||"S/C")}}function M(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Serie"),e.qZA())}function O(n,a){if(1&n&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu((null==t.informe_baja_elemento?null:t.informe_baja_elemento.numero_serie)||"-")}}function w(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Equipo"),e.qZA())}function I(n,a){if(1&n&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(null==t.informe_baja_elemento?null:t.informe_baja_elemento.equipo)}}function P(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Stock"),e.qZA())}function y(n,a){if(1&n&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(t.informe_baja_elemento.cantidad)}}function q(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Cant. a enviar"),e.qZA())}function N(n,a){if(1&n&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Oqu(t.cantidad_inventariado)}}function Y(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Base"),e.qZA())}function E(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",24)(1,"input",25),e.NdJ("change",function(i){const m=e.CHM(t).index,s=e.oxw();return e.KtG(s.editarPrecio(i,m))}),e.qZA()()}if(2&n){const t=a.$implicit,o=e.oxw();e.xp6(1),e.Q6J("value",t.precio_base)("disabled",!o.puedeEditar)}}function Q(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"BaseXQ"),e.qZA())}function D(n,a){if(1&n&&(e.TgZ(0,"td",24),e._UZ(1,"input",26),e.qZA()),2&n){const t=a.$implicit,o=e.oxw();e.xp6(1),e.Q6J("value",t.cantidad_inventariado*t.precio_base)("disabled",!o.puedeEditar)}}function F(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"IGV"),e.qZA())}function J(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",24)(1,"input",28),e.NdJ("change",function(i){const m=e.CHM(t).index,s=e.oxw(2);return e.KtG(s.editarIgv(i,m))}),e.qZA()()}if(2&n){const t=a.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("value",t.igv)("disabled",!o.puedeEditar)("disabled",!o.puedeEditar)}}function S(n,a){1&n&&(e.ynx(0,27),e.YNc(1,F,2,0,"th",5),e.YNc(2,J,2,3,"td",6),e.BQk())}function k(n,a){1&n&&(e.TgZ(0,"th",23),e._uU(1,"Precio Final"),e.qZA())}function G(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"input",30),e.NdJ("change",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.calcularTotal())}),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.Q6J("value",t.cantidad_inventariado*t.precio_base+t.igv)}}function H(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"input",30),e.NdJ("change",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.calcularTotal())}),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.Q6J("value",t.cantidad_inventariado*t.precio_base)}}function $(n,a){if(1&n&&(e.TgZ(0,"td",24),e.YNc(1,G,1,1,"input",29),e.YNc(2,H,1,1,"input",29),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",3===t.empresaId),e.xp6(1),e.Q6J("ngIf",3!=t.empresaId)}}function z(n,a){1&n&&e._UZ(0,"tr",31)}function L(n,a){1&n&&e._UZ(0,"tr",32)}function K(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.aprobar())}),e._uU(1," Aprobar "),e.qZA()}if(2&n){const t=e.oxw();e.ekj("btn-principal-off",!t.puedeAprobar),e.Q6J("disabled",!t.puedeAprobar)}}let C=(()=>{class n{constructor(t,o,i,d,m,s){this.formBuilder=t,this.router=o,this.ventaElementoGetService=i,this.ventaPostService=d,this.activatedRoute=m,this.modal=s,this.tablaCabecera=["id","informe","codigoActivo","serie","equipo","cantidad","cantidadAEnviar","base","basexq"],this.dataSourceAux=[],this.listaInformeVentaElemento=[],this.informeVentaId=0,this.sesion=(0,_.l3)(),this.puedeEditar=!!(0,_.Gs)(c.w3,c.ch),this.puedeAprobar=!!(0,_.Gs)(c.w3,c.yG),this.precioFinal=0,this.estadoInforme="",this.empresaId=0}ngOnInit(){this.construirFormulario(),this.activatedRoute.params.subscribe(t=>{this.informeVentaId=parseInt(t.idInformeVenta),this.cargarTabla(this.informeVentaId)})}construirFormulario(){this.formulario=this.formBuilder.group({precioTotal:new p.NI({value:"",disabled:!0},p.kI.required),importeTotal:new p.NI({value:"",disabled:!0},p.kI.required)})}cargarTabla(t){this.ventaElementoGetService.obtenerListaInformeVentaElementoPorInformeVentaConInventariado(t).then(o=>{3===this.empresaId&&this.tablaCabecera.push("igv"),this.tablaCabecera.push("preciofinal"),this.listaInformeVentaElemento=o.data.lista_informe_venta_elemento,this.estadoInforme=this.listaInformeVentaElemento[0].informe_venta.estado,this.calcularTotal(),this.dataSource=new l.by(o.data.lista_informe_venta_elemento)})}aprobar(){this.modal.open(h._,{data:{titulo:c.in,accion:c.x9+c.th,opciones:2},disableClose:!0}).afterClosed().subscribe(t=>{if(t){let o={informe_venta_id:this.informeVentaId,estado:c.Gq,lista_informe_venta_elemento:this.obtenerListaInformeVentaElementoRequest()};this.ventaPostService.aprobarInformeVenta(o).then(i=>{"0"===i.codigo&&this.modal.open(h._,{data:{titulo:c.in,accion:c.H1,opciones:1},disableClose:!0}).afterClosed().subscribe(d=>{this.router.navigate(["main/venta-baja"])})})}})}editarPrecio(t,o){this.listaInformeVentaElemento[o].precio_base=parseFloat(t.target.value),this.calcularTotal()}editarIgv(t,o){let i=parseFloat(t.target.value);this.listaInformeVentaElemento[o].igv=i,this.calcularTotal()}calcularTotal(){this.precioFinal=0,this.listaInformeVentaElemento.forEach(t=>{this.precioFinal=this.precioFinal+t.cantidad_inventariado*t.precio_base+t.igv})}obtenerListaInformeVentaElementoRequest(){let t=[];return this.listaInformeVentaElemento.forEach(o=>{t.push({id:o.id,precio_base:o.precio_base,igv:o.igv,informe_baja_elemento_id:o.informe_baja_elemento.id,usuario_id_edicion:this.sesion.usuario.id,estado:c.Gq})}),t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.qu),e.Y36(u.F0),e.Y36(v.m),e.Y36(A.R),e.Y36(u.gz),e.Y36(b.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ne-adm-gact-venta-baja-reporte-usuario-aprobar"]],decls:43,vars:6,consts:[[1,"contenedor-pagina","paddinng-top-5"],[1,"contenedor-pagina-cuerpo"],[1,"contenedor-no-hover"],["mat-table","","matSort","","matSortActive","created","matSortDisableClear","","matSortDirection","desc",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","informe"],["matColumnDef","codigoActivo"],["matColumnDef","serie"],["matColumnDef","equipo"],["matColumnDef","cantidad"],["matColumnDef","cantidadAEnviar"],["matColumnDef","base"],["matColumnDef","basexq"],["matColumnDef","igv",4,"ngIf"],["matColumnDef","preciofinal"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"contenedor-pagina-pie"],["for","nombre",1,"paddinng-top-5","paddinng-derecho-15"],["type","text","name","precioTotal","id","precioTotal","maxlength","300",3,"value"],["class","btn-principal",3,"btn-principal-off","disabled","click",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["type","text","inputmode","numeric","name","base","id","base","maxlength","300",3,"value","disabled","change"],["type","text","name","basexq","id","basexq","readonly","true","maxlength","300",3,"value","disabled"],["matColumnDef","igv"],["type","text","inputmode","numeric","name","igv","id","igv","maxlength","300",3,"value","disabled","change"],["type","text","name","preciofinal","id","preciofinal","class","min-width-precio","maxlength","300","readonly","true",3,"value","change",4,"ngIf"],["type","text","name","preciofinal","id","preciofinal","maxlength","300","readonly","true",1,"min-width-precio",3,"value","change"],["mat-header-row",""],["mat-row",""],[1,"btn-principal",3,"disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"table",3),e.ynx(4,4),e.YNc(5,T,2,0,"th",5),e.YNc(6,U,2,1,"td",6),e.BQk(),e.ynx(7,7),e.YNc(8,V,2,0,"th",5),e.YNc(9,B,2,1,"td",6),e.BQk(),e.ynx(10,8),e.YNc(11,Z,2,0,"th",5),e.YNc(12,R,2,1,"td",6),e.BQk(),e.ynx(13,9),e.YNc(14,M,2,0,"th",5),e.YNc(15,O,2,1,"td",6),e.BQk(),e.ynx(16,10),e.YNc(17,w,2,0,"th",5),e.YNc(18,I,2,1,"td",6),e.BQk(),e.ynx(19,11),e.YNc(20,P,2,0,"th",5),e.YNc(21,y,2,1,"td",6),e.BQk(),e.ynx(22,12),e.YNc(23,q,2,0,"th",5),e.YNc(24,N,2,1,"td",6),e.BQk(),e.ynx(25,13),e.YNc(26,Y,2,0,"th",5),e.YNc(27,E,2,2,"td",6),e.BQk(),e.ynx(28,14),e.YNc(29,Q,2,0,"th",5),e.YNc(30,D,2,2,"td",6),e.BQk(),e.YNc(31,S,3,0,"ng-container",15),e.ynx(32,16),e.YNc(33,k,2,0,"th",5),e.YNc(34,$,3,2,"td",6),e.BQk(),e.YNc(35,z,1,0,"tr",17),e.YNc(36,L,1,0,"tr",18),e.qZA()()(),e.TgZ(37,"div",19)(38,"label",20),e._uU(39,"Total:"),e.qZA(),e._UZ(40,"input",21),e.qZA(),e.TgZ(41,"div",19),e.YNc(42,K,2,3,"button",22),e.qZA()()),2&t&&(e.xp6(3),e.Q6J("dataSource",o.dataSource),e.xp6(28),e.Q6J("ngIf",3===o.empresaId),e.xp6(4),e.Q6J("matHeaderRowDef",o.tablaCabecera),e.xp6(1),e.Q6J("matRowDefColumns",o.tablaCabecera),e.xp6(4),e.Q6J("value",o.precioFinal),e.xp6(2),e.Q6J("ngIf","VALIDADO"===o.estadoInforme))},dependencies:[g.O5,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk],styles:[".contenedor-principal[_ngcontent-%COMP%]{width:100%;height:90%}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-tabla[_ngcontent-%COMP%]{width:calc(100% - 20px);height:80%;background-color:#313135;align-items:center;border-radius:6px;margin-left:10px;margin-right:10px;box-shadow:#0003 0 2px 8px;padding-top:2%;overflow-y:auto}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-tabla[_ngcontent-%COMP%]   .tabla[_ngcontent-%COMP%]{width:95%!important;margin-top:0}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-tabla[_ngcontent-%COMP%]   .tabla[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:#3b3b40!important;color:#a9a9b2;border:0!important;font-size:1rem;height:38px;transition:all .3s;font-family:Roboto,sans-serif}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-tabla[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-acciones[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(100% - 20px);height:8%;background-color:#313135;border-radius:6px;margin-right:10px;margin-left:10px;margin-top:1%;box-shadow:#0003 0 2px 8px}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-acciones-centro[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:50%;height:100%;padding-left:1%}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-acciones-centro[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:1%;width:25%}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(100% - 20px);height:8%;background-color:#313135;border-radius:6px;margin-right:10px;margin-left:10px;margin-top:1%;box-shadow:#0003 0 2px 8px}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]{padding:0}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]   .formulario-cuerpo[_ngcontent-%COMP%]{margin-top:0}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]   .formulario-cuerpo[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:0;position:relative;display:flex;justify-content:center;align-items:center}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]   .formulario-cuerpo[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:0}"]}),n})();const X=[{path:"",component:C}];let W=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.Bz.forChild(X),u.Bz]}),n})();var ee=r(577),te=r(164);let ne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n,bootstrap:[C]}),n.\u0275inj=e.cJS({imports:[j.JF,g.ez,p.u5,W,p.UX,l.p0,x.Ps,b.Is,ee.VentaBajaCrearModule,te.k]}),n})()}}]);