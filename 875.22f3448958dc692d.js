"use strict";(self.webpackChunknewport_erp=self.webpackChunknewport_erp||[]).push([[875],{7875:(ae,u,i)=>{i.r(u),i.d(u,{VentaBajaInformeFinalizadoModule:()=>te});var g=i(5412),h=i(6895),l=i(7155),x=i(7392),m=i(4006),j=i(529),f=i(1588),c=i(7800),b=i(4891),e=i(4650),s=i(8996),v=i(9479),I=i(2727);function T(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"#"),e.qZA())}function B(t,a){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const n=a.index;e.xp6(1),e.Oqu(n+1)}}function F(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"Codificaci\xf3n"),e.qZA())}function V(t,a){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Oqu((null==n.informe_baja_elemento||null==n.informe_baja_elemento.informe_baja||null==n.informe_baja_elemento.informe_baja.sitio||null==n.informe_baja_elemento.informe_baja.sitio.empresa?null:n.informe_baja_elemento.informe_baja.sitio.empresa.nombre_corto)+"-"+(null==n.informe_baja_elemento||null==n.informe_baja_elemento.informe_baja||null==n.informe_baja_elemento.informe_baja.departamento||null==n.informe_baja_elemento.informe_baja.departamento.area?null:n.informe_baja_elemento.informe_baja.departamento.area.nombre_corto)+"-"+(null==n.informe_baja_elemento||null==n.informe_baja_elemento.informe_baja||null==n.informe_baja_elemento.informe_baja.sitio?null:n.informe_baja_elemento.informe_baja.sitio.nombre_corto)+"-"+(null==n.informe_baja_elemento||null==n.informe_baja_elemento.informe_baja?null:n.informe_baja_elemento.informe_baja.fecha_creacion)+"-"+(null==n.informe_baja_elemento||null==n.informe_baja_elemento.informe_baja?null:n.informe_baja_elemento.informe_baja.id)||"-")}}function Z(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"C\xf3digo Activo"),e.qZA())}function z(t,a){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Oqu((null==n.informe_baja_elemento?null:n.informe_baja_elemento.codigo_activo)||"S/C")}}function M(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"Serie"),e.qZA())}function O(t,a){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Oqu((null==n.informe_baja_elemento?null:n.informe_baja_elemento.numero_serie)||"-")}}function A(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"Equipo"),e.qZA())}function P(t,a){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Oqu(null==n.informe_baja_elemento?null:n.informe_baja_elemento.equipo)}}function y(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"Stock"),e.qZA())}function w(t,a){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Oqu(n.ultimo_stock||n.informe_baja_elemento.cantidad_sin_venta||n.informe_baja_elemento.cantidad)}}function q(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"Cant."),e.qZA())}function N(t,a){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Oqu(n.cantidad_inventariado)}}function Y(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"Nuevo Stock"),e.qZA())}function U(t,a){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Oqu(n.ultimo_stock-n.cantidad_inventariado)}}function E(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"Base"),e.qZA())}function D(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"td",25)(1,"input",26),e.NdJ("change",function(r){const d=e.CHM(n).index,p=e.oxw();return e.KtG(p.editarPrecio(r,d))}),e.qZA()()}if(2&t){const n=a.$implicit,o=e.oxw();e.xp6(1),e.Q6J("value",n.precio_base)("disabled",!o.puedeEditar)}}function Q(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"BaseXQ"),e.qZA())}function S(t,a){if(1&t&&(e.TgZ(0,"td",25),e._UZ(1,"input",27),e.qZA()),2&t){const n=a.$implicit,o=e.oxw();e.xp6(1),e.Q6J("value",n.cantidad_inventariado*n.precio_base)("disabled",!o.puedeEditar)}}function k(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"IGV"),e.qZA())}function J(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"td",25)(1,"input",29),e.NdJ("change",function(r){const d=e.CHM(n).index,p=e.oxw(2);return e.KtG(p.editarIgv(r,d))}),e.qZA()()}if(2&t){const n=a.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("value",n.igv)("disabled",!o.puedeEditar)("disabled",!o.puedeEditar)}}function R(t,a){1&t&&(e.ynx(0,28),e.YNc(1,k,2,0,"th",5),e.YNc(2,J,2,3,"td",6),e.BQk())}function G(t,a){1&t&&(e.TgZ(0,"th",24),e._uU(1,"Precio Final"),e.qZA())}function $(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"td",25)(1,"input",30),e.NdJ("change",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.calcularTotal())}),e.qZA()()}if(2&t){const n=a.$implicit;e.xp6(1),e.Q6J("value",(null==n.informe_baja_elemento?null:n.informe_baja_elemento.cantidad)*n.precio_base+n.igv)}}function H(t,a){1&t&&e._UZ(0,"tr",31)}function L(t,a){1&t&&e._UZ(0,"tr",32)}function K(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"button",33),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.aprobar())}),e._uU(1," Aprobar "),e.qZA()}if(2&t){const n=e.oxw();e.ekj("btn-principal-off",!n.puedeAprobar),e.Q6J("disabled",!n.puedeAprobar)}}let C=(()=>{class t{constructor(n,o,r,_,d,p){this.formBuilder=n,this.router=o,this.ventaElementoGetService=r,this.ventaPostService=_,this.activatedRoute=d,this.modal=p,this.tablaCabecera=["id","informe","codigoActivo","serie","equipo","cantidad","cantidadAEnviar","nuevoStock","base","basexq"],this.dataSourceAux=[],this.listaInformeVentaElemento=[],this.informeVentaId=0,this.sesion=(0,f.l3)(),this.puedeEditar=!!(0,f.Gs)(c.w3,c.ch),this.puedeAprobar=!!(0,f.Gs)(c.w3,c.yG),this.precioFinal=0,this.estadoInforme="",this.empresaId=0}ngOnInit(){console.info("asdnasdlasdasd"),this.construirFormulario(),this.activatedRoute.params.subscribe(n=>{this.informeVentaId=parseInt(n.idInformeVenta),this.cargarTabla(this.informeVentaId)})}construirFormulario(){this.formulario=this.formBuilder.group({precioTotal:new m.NI({value:"",disabled:!0},m.kI.required),importeTotal:new m.NI({value:"",disabled:!0},m.kI.required)})}cargarTabla(n){this.ventaElementoGetService.obtenerListaInformeVentaElementoPorInformeVentaFinalizado(n).then(o=>{3===this.empresaId&&this.tablaCabecera.push("igv"),this.tablaCabecera.push("preciofinal"),this.listaInformeVentaElemento=o.data.lista_informe_venta_elemento,this.estadoInforme=this.listaInformeVentaElemento[0].informe_venta.estado,this.calcularTotal(),this.dataSource=new l.by(o.data.lista_informe_venta_elemento)})}aprobar(){this.modal.open(b._,{data:{titulo:c.in,accion:c.x9+c.th,opciones:2},disableClose:!0}).afterClosed().subscribe(n=>{if(n){let o={informe_venta_id:this.informeVentaId,estado:c.Gq,lista_informe_venta_elemento:this.obtenerListaInformeVentaElementoRequest()};this.ventaPostService.aprobarInformeVenta(o).then(r=>{"0"===r.codigo&&this.modal.open(b._,{data:{titulo:c.in,accion:c.H1,opciones:1},disableClose:!0}).afterClosed().subscribe(_=>{this.router.navigate(["main/venta-baja"])})})}})}editarPrecio(n,o){this.listaInformeVentaElemento[o].precio_base=parseFloat(n.target.value),this.calcularTotal()}editarIgv(n,o){let r=parseFloat(n.target.value);this.listaInformeVentaElemento[o].igv=r,this.calcularTotal()}calcularTotal(){this.precioFinal=0,this.listaInformeVentaElemento.forEach(n=>{this.precioFinal=this.precioFinal+n.informe_baja_elemento.cantidad*n.precio_base+n.igv})}obtenerListaInformeVentaElementoRequest(){let n=[];return this.listaInformeVentaElemento.forEach(o=>{n.push({id:o.id,precio_base:o.precio_base,igv:o.igv,informe_baja_elemento_id:o.informe_baja_elemento.id,usuario_id_edicion:this.sesion.usuario.id,estado:c.Gq})}),n}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(m.qu),e.Y36(s.F0),e.Y36(v.m),e.Y36(I.R),e.Y36(s.gz),e.Y36(g.uw))},t.\u0275cmp=e.Xpm({type:t,selectors:[["ne-adm-gact-venta-baja-informe-finalizado"]],decls:46,vars:6,consts:[[1,"contenedor-pagina","paddinng-top-5"],[1,"contenedor-pagina-cuerpo"],[1,"contenedor-no-hover"],["mat-table","","matSort","","matSortActive","created","matSortDisableClear","","matSortDirection","desc",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","informe"],["matColumnDef","codigoActivo"],["matColumnDef","serie"],["matColumnDef","equipo"],["matColumnDef","cantidad"],["matColumnDef","cantidadAEnviar"],["matColumnDef","nuevoStock"],["matColumnDef","base"],["matColumnDef","basexq"],["matColumnDef","igv",4,"ngIf"],["matColumnDef","preciofinal"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"contenedor-pagina-pie"],["for","nombre",1,"paddinng-top-5","paddinng-derecho-15"],["type","text","name","precioTotal","id","precioTotal","maxlength","300",3,"value"],["class","btn-principal",3,"btn-principal-off","disabled","click",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["type","text","inputmode","numeric","name","base","id","base","maxlength","300",3,"value","disabled","change"],["type","text","name","basexq","id","basexq","readonly","true","maxlength","300",3,"value","disabled"],["matColumnDef","igv"],["type","text","inputmode","numeric","name","igv","id","igv","maxlength","300",3,"value","disabled","change"],["type","text","name","preciofinal","id","preciofinal","maxlength","300","readonly","true",3,"value","change"],["mat-header-row",""],["mat-row",""],[1,"btn-principal",3,"disabled","click"]],template:function(n,o){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"table",3),e.ynx(4,4),e.YNc(5,T,2,0,"th",5),e.YNc(6,B,2,1,"td",6),e.BQk(),e.ynx(7,7),e.YNc(8,F,2,0,"th",5),e.YNc(9,V,2,1,"td",6),e.BQk(),e.ynx(10,8),e.YNc(11,Z,2,0,"th",5),e.YNc(12,z,2,1,"td",6),e.BQk(),e.ynx(13,9),e.YNc(14,M,2,0,"th",5),e.YNc(15,O,2,1,"td",6),e.BQk(),e.ynx(16,10),e.YNc(17,A,2,0,"th",5),e.YNc(18,P,2,1,"td",6),e.BQk(),e.ynx(19,11),e.YNc(20,y,2,0,"th",5),e.YNc(21,w,2,1,"td",6),e.BQk(),e.ynx(22,12),e.YNc(23,q,2,0,"th",5),e.YNc(24,N,2,1,"td",6),e.BQk(),e.ynx(25,13),e.YNc(26,Y,2,0,"th",5),e.YNc(27,U,2,1,"td",6),e.BQk(),e.ynx(28,14),e.YNc(29,E,2,0,"th",5),e.YNc(30,D,2,2,"td",6),e.BQk(),e.ynx(31,15),e.YNc(32,Q,2,0,"th",5),e.YNc(33,S,2,2,"td",6),e.BQk(),e.YNc(34,R,3,0,"ng-container",16),e.ynx(35,17),e.YNc(36,G,2,0,"th",5),e.YNc(37,$,2,1,"td",6),e.BQk(),e.YNc(38,H,1,0,"tr",18),e.YNc(39,L,1,0,"tr",19),e.qZA()()(),e.TgZ(40,"div",20)(41,"label",21),e._uU(42,"Total:"),e.qZA(),e._UZ(43,"input",22),e.qZA(),e.TgZ(44,"div",20),e.YNc(45,K,2,3,"button",23),e.qZA()()),2&n&&(e.xp6(3),e.Q6J("dataSource",o.dataSource),e.xp6(31),e.Q6J("ngIf",3===o.empresaId),e.xp6(4),e.Q6J("matHeaderRowDef",o.tablaCabecera),e.xp6(1),e.Q6J("matRowDefColumns",o.tablaCabecera),e.xp6(4),e.Q6J("value",o.precioFinal),e.xp6(2),e.Q6J("ngIf","VALIDADO"===o.estadoInforme))},dependencies:[h.O5,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk],styles:[".contenedor-principal[_ngcontent-%COMP%]{width:100%;height:90%}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-tabla[_ngcontent-%COMP%]{width:calc(100% - 20px);height:80%;background-color:#313135;align-items:center;border-radius:6px;margin-left:10px;margin-right:10px;box-shadow:#0003 0 2px 8px;padding-top:2%;overflow-y:auto}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-tabla[_ngcontent-%COMP%]   .tabla[_ngcontent-%COMP%]{width:95%!important;margin-top:0}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-tabla[_ngcontent-%COMP%]   .tabla[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:#3b3b40!important;color:#a9a9b2;border:0!important;font-size:1rem;height:38px;transition:all .3s;font-family:Roboto,sans-serif}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-tabla[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-acciones[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(100% - 20px);height:8%;background-color:#313135;border-radius:6px;margin-right:10px;margin-left:10px;margin-top:1%;box-shadow:#0003 0 2px 8px}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-acciones-centro[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:50%;height:100%;padding-left:1%}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-acciones-centro[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:1%;width:25%}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:calc(100% - 20px);height:8%;background-color:#313135;border-radius:6px;margin-right:10px;margin-left:10px;margin-top:1%;box-shadow:#0003 0 2px 8px}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]{padding:0}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]   .formulario-cuerpo[_ngcontent-%COMP%]{margin-top:0}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]   .formulario-cuerpo[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:0;position:relative;display:flex;justify-content:center;align-items:center}.contenedor-principal[_ngcontent-%COMP%]   .contenedor-importes[_ngcontent-%COMP%]   .formulario-cuerpo[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:0}"]}),t})();const X=[{path:"",component:C}];let W=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[s.Bz.forChild(X),s.Bz]}),t})();var ee=i(577),ne=i(164);let te=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t,bootstrap:[C]}),t.\u0275inj=e.cJS({imports:[j.JF,h.ez,m.u5,W,m.UX,l.p0,x.Ps,g.Is,ee.VentaBajaCrearModule,ne.k]}),t})()}}]);